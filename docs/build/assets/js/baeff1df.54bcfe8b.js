"use strict";(globalThis.webpackChunkimperium_docs=globalThis.webpackChunkimperium_docs||[]).push([[864],{7969(e,n,i){i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>s,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"api/authentication","title":"Autenticacao","description":"O Imperium utiliza JWT (JSON Web Tokens) para autenticacao.","source":"@site/docs/api/authentication.md","sourceDirName":"api","slug":"/api/authentication","permalink":"/api/authentication","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"tutorialSidebar","previous":{"title":"Models","permalink":"/api/models"},"next":{"title":"Setup do Ambiente","permalink":"/guides/setup"}}');var a=i(4848),t=i(8453);const s={sidebar_position:3},o="Autenticacao",d={},c=[{value:"Fluxo de Autenticacao",id:"fluxo-de-autenticacao",level:2},{value:"JWT Token",id:"jwt-token",level:2},{value:"Estrutura do Token",id:"estrutura-do-token",level:3},{value:"Configuracao",id:"configuracao",level:3},{value:"Usando o Token",id:"usando-o-token",level:2},{value:"Header de Autorizacao",id:"header-de-autorizacao",level:3},{value:"Exemplo com cURL",id:"exemplo-com-curl",level:3},{value:"Exemplo com JavaScript",id:"exemplo-com-javascript",level:3},{value:"Exemplo com Dart/Flutter",id:"exemplo-com-dartflutter",level:3},{value:"Erros de Autenticacao",id:"erros-de-autenticacao",level:2},{value:"Seguranca",id:"seguranca",level:2},{value:"Senha",id:"senha",level:3},{value:"Boas Praticas",id:"boas-praticas",level:3}];function l(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"autenticacao",children:"Autenticacao"})}),"\n",(0,a.jsxs)(n.p,{children:["O Imperium utiliza ",(0,a.jsx)(n.strong,{children:"JWT (JSON Web Tokens)"})," para autenticacao."]}),"\n",(0,a.jsx)(n.h2,{id:"fluxo-de-autenticacao",children:"Fluxo de Autenticacao"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Cliente \u2502         \u2502   API    \u2502         \u2502 MongoDB  \u2502\n\u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518         \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518         \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518\n     \u2502                    \u2502                    \u2502\n     \u2502 POST /auth/login   \u2502                    \u2502\n     \u2502 {email, password}  \u2502                    \u2502\n     \u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500>\u2502                    \u2502\n     \u2502                    \u2502  Find user         \u2502\n     \u2502                    \u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500>\u2502\n     \u2502                    \u2502                    \u2502\n     \u2502                    \u2502  User data         \u2502\n     \u2502                    \u2502<\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502\n     \u2502                    \u2502                    \u2502\n     \u2502                    \u2502 Verify password    \u2502\n     \u2502                    \u2502 Generate JWT       \u2502\n     \u2502                    \u2502                    \u2502\n     \u2502 {user, token}      \u2502                    \u2502\n     \u2502<\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502                    \u2502\n     \u2502                    \u2502                    \u2502\n     \u2502 GET /api/v1/...    \u2502                    \u2502\n     \u2502 Authorization:     \u2502                    \u2502\n     \u2502 Bearer <token>     \u2502                    \u2502\n     \u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500>\u2502                    \u2502\n     \u2502                    \u2502                    \u2502\n     \u2502                    \u2502 Validate JWT       \u2502\n     \u2502                    \u2502 Extract userID     \u2502\n     \u2502                    \u2502                    \u2502\n     \u2502 Response           \u2502                    \u2502\n     \u2502<\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502                    \u2502\n     \u2502                    \u2502                    \u2502\n"})}),"\n",(0,a.jsx)(n.h2,{id:"jwt-token",children:"JWT Token"}),"\n",(0,a.jsx)(n.h3,{id:"estrutura-do-token",children:"Estrutura do Token"}),"\n",(0,a.jsx)(n.p,{children:"O token JWT contem as seguintes claims:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n  "user_id": "65abc123def456789",\n  "email": "usuario@email.com",\n  "exp": 1705320000,\n  "iat": 1704715200,\n  "iss": "imperium-api"\n}\n'})}),"\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"Claim"}),(0,a.jsx)(n.th,{children:"Descricao"})]})}),(0,a.jsxs)(n.tbody,{children:[(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"user_id"})}),(0,a.jsx)(n.td,{children:"ID do usuario no MongoDB"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"email"})}),(0,a.jsx)(n.td,{children:"Email do usuario"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"exp"})}),(0,a.jsx)(n.td,{children:"Data de expiracao (Unix timestamp)"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"iat"})}),(0,a.jsx)(n.td,{children:"Data de emissao (Unix timestamp)"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"iss"})}),(0,a.jsx)(n.td,{children:"Emissor do token"})]})]})]}),"\n",(0,a.jsx)(n.h3,{id:"configuracao",children:"Configuracao"}),"\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"Variavel"}),(0,a.jsx)(n.th,{children:"Default"}),(0,a.jsx)(n.th,{children:"Descricao"})]})}),(0,a.jsxs)(n.tbody,{children:[(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"JWT_SECRET"})}),(0,a.jsx)(n.td,{children:"-"}),(0,a.jsx)(n.td,{children:"Chave secreta para assinatura"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"JWT_EXPIRY"})}),(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"168h"})}),(0,a.jsx)(n.td,{children:"Tempo de expiracao (7 dias)"})]})]})]}),"\n",(0,a.jsx)(n.admonition,{title:"Importante",type:"danger",children:(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Nunca"})," compartilhe ou exponha o ",(0,a.jsx)(n.code,{children:"JWT_SECRET"})," em producao."]})}),"\n",(0,a.jsx)(n.h2,{id:"usando-o-token",children:"Usando o Token"}),"\n",(0,a.jsx)(n.h3,{id:"header-de-autorizacao",children:"Header de Autorizacao"}),"\n",(0,a.jsxs)(n.p,{children:["Todas as rotas protegidas requerem o header ",(0,a.jsx)(n.code,{children:"Authorization"}),":"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-http",children:"GET /api/v1/profile HTTP/1.1\nHost: localhost:8080\nAuthorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\n"})}),"\n",(0,a.jsx)(n.h3,{id:"exemplo-com-curl",children:"Exemplo com cURL"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'# Login\nTOKEN=$(curl -s -X POST http://localhost:8080/api/v1/auth/login \\\n  -H "Content-Type: application/json" \\\n  -d \'{"email":"user@email.com","password":"senha123"}\' \\\n  | jq -r \'.token\')\n\n# Usar o token\ncurl -X GET http://localhost:8080/api/v1/profile \\\n  -H "Authorization: Bearer $TOKEN"\n'})}),"\n",(0,a.jsx)(n.h3,{id:"exemplo-com-javascript",children:"Exemplo com JavaScript"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-javascript",children:"// Login\nconst response = await fetch('/api/v1/auth/login', {\n  method: 'POST',\n  headers: { 'Content-Type': 'application/json' },\n  body: JSON.stringify({ email, password })\n});\nconst { token } = await response.json();\n\n// Armazenar token\nlocalStorage.setItem('token', token);\n\n// Usar em requisicoes\nconst profile = await fetch('/api/v1/profile', {\n  headers: { 'Authorization': `Bearer ${token}` }\n});\n"})}),"\n",(0,a.jsx)(n.h3,{id:"exemplo-com-dartflutter",children:"Exemplo com Dart/Flutter"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-dart",children:"// Login\nfinal response = await http.post(\n  Uri.parse('$baseUrl/api/v1/auth/login'),\n  headers: {'Content-Type': 'application/json'},\n  body: jsonEncode({'email': email, 'password': password}),\n);\nfinal token = jsonDecode(response.body)['token'];\n\n// Usar em requisicoes\nfinal profile = await http.get(\n  Uri.parse('$baseUrl/api/v1/profile'),\n  headers: {'Authorization': 'Bearer $token'},\n);\n"})}),"\n",(0,a.jsx)(n.h2,{id:"erros-de-autenticacao",children:"Erros de Autenticacao"}),"\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"Status"}),(0,a.jsx)(n.th,{children:"Mensagem"}),(0,a.jsx)(n.th,{children:"Causa"})]})}),(0,a.jsxs)(n.tbody,{children:[(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"401"})}),(0,a.jsx)(n.td,{children:"Authorization header required"}),(0,a.jsx)(n.td,{children:"Header ausente"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"401"})}),(0,a.jsx)(n.td,{children:"Invalid authorization format"}),(0,a.jsx)(n.td,{children:"Formato incorreto"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"401"})}),(0,a.jsx)(n.td,{children:"Invalid or expired token"}),(0,a.jsx)(n.td,{children:"Token invalido ou expirado"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"401"})}),(0,a.jsx)(n.td,{children:"Invalid user ID in token"}),(0,a.jsx)(n.td,{children:"Token corrompido"})]})]})]}),"\n",(0,a.jsx)(n.h2,{id:"seguranca",children:"Seguranca"}),"\n",(0,a.jsx)(n.h3,{id:"senha",children:"Senha"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Minimo 6 caracteres"}),"\n",(0,a.jsxs)(n.li,{children:["Hash com ",(0,a.jsx)(n.strong,{children:"bcrypt"})," (cost 12)"]}),"\n",(0,a.jsx)(n.li,{children:"Nunca armazenada em texto plano"}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"boas-praticas",children:"Boas Praticas"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Armazene tokens de forma segura"})," - Use ",(0,a.jsx)(n.code,{children:"SecureStorage"})," em mobile"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Renove tokens antes de expirar"})," - Implemente refresh token"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Use HTTPS em producao"})," - Proteja tokens em transito"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Invalide tokens no logout"})," - Implemente blacklist se necessario"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(l,{...e})}):l(e)}},8453(e,n,i){i.d(n,{R:()=>s,x:()=>o});var r=i(6540);const a={},t=r.createContext(a);function s(e){const n=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);